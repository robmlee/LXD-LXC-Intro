# Using Custom Profiles

**為何我們需要客製化設定檔(Custom Profile)**

- 每個 Linux Container(LXC)/VM 可能會有不同系統環境參數設定。
- 這些參數設定，若只是指令操作，沒特別記錄下來，很容易就忘了當初怎麼設的？設定那些參數等等。
- 若能有個客製化設定檔(Custom Profile)，問題便能迎刃而解。
- 將需要的系統環境參數，記錄在客製化設定檔(Custom Profile)中，不論是事後再增加、修改、查詢設定，或是系統回復與再建，任務交接等，就會簡單輕鬆，清楚明瞭了。

## 一、建自己的 Custom Profile

### 1. 利用模板來建自己的 Custom Profile
- **1-1. 模板內容**
  **建立模板設定檔**
  ```bash=
  vi profile_sample.yaml
  ```

  **填入模板內容**
  ```text=
  name: routed_192.168.1.240                # <-- Profile 名，可自行修改
  description: Routed 192.168.1.240 n8n     # <-- Profile 說明，可自行修改
  config:
    boot.autostart: "false"
    boot.autostart.delay: "0"
    #limits.cpu: "4"
    #limits.memory: 8GiB
    #limits.memory.swap: false
    ##
    ## === 開始 Docker 需要的設定 === 
    linux.kernel_modules: p_tables,ip6_tables,nf_nat,overlay,br_netfilter   
    raw.lxc: "lxc.apparmor.profile=unconfined\nlxc.cap.drop= \nlxc.cgroup.devices.allow=a\nlxc.mount.auto=proc:rw sys:rw" 
    security.nesting: "true" 
    security.privileged: "true"
    security.syscalls.intercept.mknod: "true"
    security.syscalls.intercept.setxattr: "true"
    ## === 結束 Docker 需要的設定 ===
    ##
    user.network-config: |
      #cloud-config
      version: 2
      ethernets:
          eth0:
              addresses:
              - 192.168.1.240/32      # <-- 設定 lxc/VM 固定 IP
              dhcp4: no
              dhcp6: no
              gateway4: 192.168.1.1   # <-- 設定 lxc/VM Gateway IP
              nameservers:
                  addresses: [168.95.192.1, 168.95.1.1]   # <-- 設定 DNS IP
                  search: []
              routes:
              -   to: 0.0.0.0/0
                  via: 169.254.0.1
                  on-link: true
  devices:
    eth0:
      ipv4.address: 192.168.1.240     # <-- 設定 lxc/VM 固定 IP (需與上面 IP 相同)
      nictype: routed
      parent: enp6s0                  # <-- Host 網卡名稱，須依每部 Host 網卡來設定
      type: nic
  used_by: []
  ```
